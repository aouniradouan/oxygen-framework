<!DOCTYPE html>
<html>
<head>
    <title>Security Scan Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        h1 { color: #333; border-bottom: 3px solid #e74c3c; padding-bottom: 10px; }
        .summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-box { padding: 20px; border-radius: 5px; text-align: center; }
        .stat-box h3 { margin: 0; font-size: 32px; }
        .stat-box p { margin: 5px 0 0 0; color: #666; }
        .critical { background: #ffebee; border-left: 4px solid #c62828; }
        .high { background: #fff3e0; border-left: 4px solid #ef6c00; }
        .medium { background: #fff9c4; border-left: 4px solid #f9a825; }
        .low { background: #e8f5e9; border-left: 4px solid #2e7d32; }
        .vulnerability { margin: 15px 0; padding: 15px; border-radius: 5px; border-left: 4px solid #ccc; }
        .vulnerability h4 { margin: 0 0 10px 0; }
        .vulnerability code { background: #f5f5f5; padding: 10px; display: block; overflow-x: auto; }
        .severity-badge { display: inline-block; padding: 3px 8px; border-radius: 3px; font-size: 12px; font-weight: bold; color: white; }
        .severity-critical { background: #c62828; }
        .severity-high { background: #ef6c00; }
        .severity-medium { background: #f9a825; }
        .severity-low { background: #2e7d32; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”’ Security Scan Report</h1>
        <p><strong>Scan Date:</strong> 2025-11-28 16:06:31</p>
        <p><strong>Mode:</strong> Balanced</p>
        
        <div class="summary">
            <div class="stat-box">
                <h3>145</h3>
                <p>Files Scanned</p>
            </div>
            <div class="stat-box critical">
                <h3>4</h3>
                <p>Critical Issues</p>
            </div>
            <div class="stat-box high">
                <h3>7</h3>
                <p>High Issues</p>
            </div>
            <div class="stat-box medium">
                <h3>1</h3>
                <p>Medium Issues</p>
            </div>
            <div class="stat-box low">
                <h3>0</h3>
                <p>Low Issues</p>
            </div>
        </div>

        <h2>Vulnerabilities Found</h2>
                <div class="vulnerability high">
                    <h4>
                        <span class="severity-badge severity-high">HIGH</span>
                        CSRF in app\Console\Commands\Generator\Generators\AuthGenerator.php:232
                    </h4>
                    <p>POST form without CSRF protection detected</p></div>
                <div class="vulnerability high">
                    <h4>
                        <span class="severity-badge severity-high">HIGH</span>
                        XSS in app\Controllers\Controller.php:19
                    </h4>
                    <p>Unescaped echo statement - potential XSS vulnerability</p><code>18: $view = $this-&gt;app-&gt;make(View::class);
19: echo $view-&gt;render($template, $data);
20: }
21: </code></div>
                <div class="vulnerability critical">
                    <h4>
                        <span class="severity-badge severity-critical">CRITICAL</span>
                        SQL Injection in app\Core\Database\Relations\Relation.php:276
                    </h4>
                    <p>Direct SQL query concatenation detected - use prepared statements</p><code>275: if ($count) {
276: $sql = &quot;SELECT COUNT(*) as count FROM {$table}&quot;;
277: } else {
278: $columns = implode(&#039;, &#039;, $this-&gt;select);</code></div>
                <div class="vulnerability critical">
                    <h4>
                        <span class="severity-badge severity-critical">CRITICAL</span>
                        SQL Injection in app\Core\Model.php:154
                    </h4>
                    <p>Direct SQL query concatenation detected - use prepared statements</p><code>153: $placeholders = implode(&#039;,&#039;, array_fill(0, count($values), &#039;?&#039;));
154: $sql = &#039;SELECT * FROM &#039; . static::getTableName() . &#039; WHERE &#039; . $column . &#039; IN (&#039; . $placeholders . &#039;)&#039;;
155: 
156: $results = static::db()-&gt;query($sql, ...$values)-&gt;fetchAll();</code></div>
                <div class="vulnerability high">
                    <h4>
                        <span class="severity-badge severity-high">HIGH</span>
                        XSS in app\Core\Response.php:44
                    </h4>
                    <p>Unescaped echo statement - potential XSS vulnerability</p><code>43: 
44: echo $this-&gt;content;
45: }
46: </code></div>
                <div class="vulnerability critical">
                    <h4>
                        <span class="severity-badge severity-critical">CRITICAL</span>
                        Dangerous Code Pattern in app\Core\Security\OxygenSecurityFixer.php:320
                    </h4>
                    <p>eval() usage detected - extremely dangerous</p><code>319: // Add warning comments for dangerous functions
320: if (strpos($vulnerability[&#039;message&#039;], &#039;eval()&#039;) !== false) {
321: $result[&#039;content&#039;] = str_replace(
322: &#039;eval(&#039;,</code></div>
                <div class="vulnerability critical">
                    <h4>
                        <span class="severity-badge severity-critical">CRITICAL</span>
                        Dangerous Code Pattern in app\Core\Security\OxygenSecurityScanner.php:281
                    </h4>
                    <p>eval() usage detected - extremely dangerous</p><code>280: $patterns = [
281: // eval() usage
282: [
283: &#039;pattern&#039; =&gt; &#039;/\beval\s*\(/i&#039;,</code></div>
                <div class="vulnerability high">
                    <h4>
                        <span class="severity-badge severity-high">HIGH</span>
                        SQL Injection in app\Core\Traits\SoftDeletes.php:74
                    </h4>
                    <p>PDO query with variable concatenation - use prepared statements</p><code>73: 
74: return $db-&gt;query(&quot;SELECT * FROM {$table} WHERE deleted_at IS NULL&quot;)-&gt;fetchAll();
75: }
76: </code></div>
                <div class="vulnerability high">
                    <h4>
                        <span class="severity-badge severity-high">HIGH</span>
                        XSS in laragon\www\oxygenframework\app\Controllers\Controller.php:19
                    </h4>
                    <p>Unescaped echo statement - potential XSS vulnerability</p><code>18: $view = $this-&gt;app-&gt;make(View::class);
19: echo $view-&gt;render($template, $data);
20: }
21: </code></div>
                <div class="vulnerability high">
                    <h4>
                        <span class="severity-badge severity-high">HIGH</span>
                        XSS in resources\views\templates\Oxygen\mobile\home.blade.php:5
                    </h4>
                    <p>Unescaped echo statement - potential XSS vulnerability</p><code>4: // foreach ($result as $row) {
5: // 	echo $row-&gt;id;
6: // 	echo $row-&gt;name;
7: // }</code></div>
                <div class="vulnerability high">
                    <h4>
                        <span class="severity-badge severity-high">HIGH</span>
                        XSS in routes\web.php:14
                    </h4>
                    <p>Unescaped echo statement - potential XSS vulnerability</p><code>13: $view = Application::getInstance()-&gt;make(\Oxygen\Core\View::class);
14: echo $view-&gt;render(&#039;pages/home.twig.html&#039;);
15: });
16: </code></div>
                <div class="vulnerability medium">
                    <h4>
                        <span class="severity-badge severity-medium">MEDIUM</span>
                        Configuration in .env:13
                    </h4>
                    <p>Debug mode enabled - should be false in production</p></div>
    </div>
</body>
</html>